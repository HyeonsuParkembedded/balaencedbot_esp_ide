# 🤖 BalanceBot 실시간 데이터 플로터

ESP32-C6 균형 로봇의 센서 데이터를 실시간으로 그래프로 표시하는 Python 도구입니다.

## 📊 표시되는 데이터

1. **기울기 각도** (°)
   - 실시간 피치 각도 변화
   - 안전 구간 (-45° ~ +45°) 표시
   - 위험 구간 시각적 표시

2. **이동 속도** (cm/s)
   - 로봇 전진/후진 속도
   - 제로 라인 표시

3. **배터리 상태**
   - 전압 (V) 및 잔량 (%) 동시 표시
   - 저전압 경고 라인
   - 위험 전압 표시

## 🚀 빠른 시작

### 1. 의존성 설치
```bash
# Python 3.7+ 필요
pip install -r requirements.txt
```

### 2. ESP32 연결 확인
ESP32가 USB로 연결되어 있고 시리얼 모니터가 **닫혀있는지** 확인하세요.

### 3. 실행
```bash
# Windows
python realtime_plotter.py --port COM4

# Linux/Mac  
python realtime_plotter.py --port /dev/ttyUSB0

# 사용자 정의 설정
python realtime_plotter.py --port COM4 --baudrate 115200 --points 1000
```

## ⚙️ 명령행 옵션

| 옵션 | 설명 | 기본값 |
|------|------|--------|
| `--port`, `-p` | 시리얼 포트 (필수) | - |
| `--baudrate`, `-b` | 통신 속도 | 115200 |
| `--points` | 최대 데이터 포인트 수 | 500 |

## 📈 그래프 특징

### 🎨 **시각적 표시**
- **다크 테마**: 눈이 편한 어두운 배경
- **실시간 상태**: 제목에 현재 상태 표시
  - ✅ BALANCING: 정상 균형 (각도 < 30°)
  - ⚡ UNSTABLE: 불안정 (30° < 각도 < 45°)
  - ⚠️ FALLEN: 넘어짐 (각도 > 45°)

### 📊 **성능 최적화**
- **고정 크기 버퍼**: 메모리 사용량 일정 유지
- **스레드 기반**: UI 블로킹 없는 부드러운 업데이트
- **100ms 간격**: 10FPS 실시간 업데이트

## 🔧 문제 해결

### ❌ 시리얼 포트 연결 실패
```
❌ 시리얼 포트 연결 실패: [Errno 2] could not open port 'COM4'
```
**해결법:**
1. ESP32가 올바른 포트에 연결되었는지 확인
2. 다른 프로그램(Arduino IDE, PlatformIO 등)에서 포트를 사용하고 있지 않은지 확인
3. Windows: 장치 관리자에서 포트 확인
4. Linux: `ls /dev/tty*` 명령으로 포트 확인

### 📡 데이터 수신 없음
```
📈 데이터 수신 대기 중...
```
**해결법:**
1. ESP32가 정상 부팅되었는지 확인
2. 시리얼 출력이 활성화되어 있는지 확인
3. 올바른 baudrate 설정 확인 (기본: 115200)

### 🐍 Python 라이브러리 오류
```
ModuleNotFoundError: No module named 'matplotlib'
```
**해결법:**
```bash
pip install -r requirements.txt
```

## 📋 ESP32 로그 형식

플로터는 다음 형식의 ESP32 로그를 파싱합니다:
```
Angle: -2.34 | Velocity: 12.5 | Battery: 7.4V(85%) | GPS: Valid
```

이 형식은 ESP32의 `status_task()` 함수에서 1Hz 주기로 출력됩니다.

## 🎯 사용 시나리오

### 🔬 **PID 튜닝**
- 실시간으로 각도 응답 확인
- 진동, 오버슈트 시각적 분석
- 안정화 시간 측정

### 🔋 **배터리 모니터링**  
- 사용 시간에 따른 전압 변화
- 성능 저하 지점 파악
- 안전한 사용 시간 예측

### 🏃 **동작 분석**
- 전진/후진 속도 패턴 분석
- 균형 제어 성능 평가
- 외부 교란에 대한 반응 측정

## 💡 팁

1. **최적 성능을 위해** ESP32 시리얼 모니터를 닫고 사용하세요
2. **긴 시간 모니터링** 시 `--points` 값을 늘리세요 (예: 2000)
3. **그래프 저장**은 matplotlib 창에서 💾 저장 버튼 클릭
4. **실시간 줌**은 마우스 휠과 드래그로 가능합니다

---

🤖 **Happy Balancing!** 🎯